"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[617],{46617:function(r,e,t){t.r(e),t.d(e,{PhantomAdapter:function(){return $}});var n=t(15671),a=t(43144),i=t(97326),o=t(11752),s=t(61120),c=t(60136),u=t(29388),p=t(74165),h=t(15861),f=t(4942),l=t(87485),d=t(37762),v=t(29068),w=t(80889),g=t.n(w),m=t(79955),y=t.n(m),Z=t(2609),b=t(23484),k=t(98689),P=t(39702),x=t.n(P);function E(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function O(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?E(Object(t),!0).forEach((function(e){(0,f.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var C=function(r){(0,c.Z)(t,r);var e=(0,u.Z)(t);function t(r){var a,c;(0,n.Z)(this,t);var u=r.config,p=r.state;if(c=e.call(this,{config:u,state:p}),(0,f.Z)((0,i.Z)(c),"_providerEngineProxy",null),!u.chainConfig)throw l.Ty.invalidProviderConfigError("Please provide chainConfig");if(!u.chainConfig.chainId)throw l.Ty.invalidProviderConfigError("Please provide chainId inside chainConfig");if(!u.chainConfig.rpcTarget)throw l.Ty.invalidProviderConfigError("Please provide rpcTarget inside chainConfig");return c.defaultState={chainId:"loading"},c.defaultConfig={chainConfig:u.chainConfig,networks:(0,f.Z)({},u.chainConfig.chainId,u.chainConfig)},(0,o.Z)((a=(0,i.Z)(c),(0,s.Z)(t.prototype)),"initialize",a).call(a),c}return(0,a.Z)(t,[{key:"provider",get:function(){return this._providerEngineProxy},set:function(r){throw new Error("Method not implemented.")}},{key:"addChain",value:function(r){if(!r.chainId)throw k.ethErrors.rpc.invalidParams("chainId is required");if(!r.rpcTarget)throw k.ethErrors.rpc.invalidParams("chainId is required");this.configure({networks:O(O({},this.config.networks),{},(0,f.Z)({},r.chainId,r))})}},{key:"getChainConfig",value:function(r){var e,t=null===(e=this.config.networks)||void 0===e?void 0:e[r];if(!t)throw k.ethErrors.rpc.invalidRequest("Chain ".concat(r," is not supported, please add chainConfig for it"));return t}},{key:"getProviderEngineProxy",value:function(){return this._providerEngineProxy}},{key:"updateProviderEngineProxy",value:function(r){this._providerEngineProxy?this._providerEngineProxy.setTarget(r):this._providerEngineProxy=(0,Z.qY)(r)}}]),t}(Z.xG),A=(x()(),t(40918).Buffer);function N(r){return function(e,t,n,a){return"solana_chainId"===e.method?(t.result=r,a()):n()}}function T(r){return function(e,t,n,a){return"solana_provider_config"===e.method?(t.result=r,a()):n()}}function _(r){var e=r.chainId;return(0,b.UZ)([N(e),T(r)])}function j(r){var e=r.rpcTarget,t=(0,Z.v$)({rpcTarget:e});return{networkMiddleware:(0,b.UZ)([_(r),t]),fetchMiddleware:t}}function M(r){var e=r.getAccounts;return(0,b.Pk)(function(){var r=(0,h.Z)((0,p.Z)().mark((function r(t,n,a){var i;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("getAccounts"===t.method){r.next=3;break}return r.abrupt("return",a());case 3:if(e){r.next=5;break}throw new Error("WalletMiddleware - opts.getAccounts not provided");case 5:return r.next=7,e(t);case 7:return i=r.sent,n.result=i,r.abrupt("return",void 0);case 10:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}())}function D(r){var e=r.requestAccounts;return(0,b.Pk)(function(){var r=(0,h.Z)((0,p.Z)().mark((function r(t,n,a){var i;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("requestAccounts"===t.method){r.next=3;break}return r.abrupt("return",a());case 3:if(e){r.next=5;break}throw new Error("WalletMiddleware - opts.requestAccounts not provided");case 5:return r.next=7,e(t);case 7:return i=r.sent,n.result=i,r.abrupt("return",void 0);case 10:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}())}function I(r,e){return(0,b.Pk)(function(){var t=(0,h.Z)((0,p.Z)().mark((function t(n,a,i){var o;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.method===r){t.next=3;break}return t.abrupt("return",i());case 3:if(e){t.next=5;break}throw new Error("WalletMiddleware - ".concat(r," not provided"));case 5:return t.next=7,e(n);case 7:return o=t.sent,a.result=o,t.abrupt("return",void 0);case 10:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}())}function S(r){var e=r.getAccounts,t=r.requestAccounts,n=r.signTransaction,a=r.signAndSendTransaction,i=r.signAllTransactions,o=r.signMessage,s=r.getPrivateKey;return(0,b.UZ)([D({requestAccounts:t}),M({getAccounts:e}),I("signTransaction",n),I("signAndSendTransaction",a),I("signAllTransactions",i),I("signMessage",o),I("solanaPrivateKey",s)])}function K(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function R(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?K(Object(t),!0).forEach((function(e){(0,f.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}function q(r){return(0,b.Pk)(function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t,n,a){var i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.request(R({},t));case 2:i=e.sent,n.result=i;case 4:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}())}var W=function(r){var e={requestAccounts:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.publicKey?[y().encode(r.publicKey.toBytes())]:[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getAccounts:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.publicKey?[y().encode(r.publicKey.toBytes())]:[]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getPrivateKey:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:throw k.ethErrors.rpc.methodNotSupported();case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),signTransaction:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){var n,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y().decode(t.params.message),a=v.YW.from(n),e.next=4,r.signTransaction(a);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signMessage:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){var n,a;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.request({method:"signMessage",params:{message:null===(n=t.params)||void 0===n?void 0:n.message}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAndSendTransaction:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){var n,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y().decode(t.params.message),a=v.YW.from(n),e.next=4,r.signAndSendTransaction(a);case 4:return i=e.sent,e.abrupt("return",{signature:i.signature});case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),signAllTransactions:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){var n,a,i,o;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.params)&&void 0!==n&&n.message&&null!==(a=t.params)&&void 0!==a&&a.message.length){e.next=2;break}throw k.ethErrors.rpc.invalidParams("message");case 2:return i=t.params.message.map((function(r){var e=y().decode(r);return v.YW.from(e)})),e.next=5,r.signAllTransactions(i);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return e};function Y(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function U(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(t),!0).forEach((function(e){(0,f.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Y(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var z=function(r){(0,c.Z)(t,r);var e=(0,u.Z)(t);function t(r){(0,n.Z)(this,t);var a=r.config,i=r.state;return e.call(this,{config:{chainConfig:U(U({},a.chainConfig),{},{chainNamespace:l.EN.SOLANA})},state:i})}return(0,a.Z)(t,[{key:"switchChain",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve());case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},{key:"setupProvider",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n,a,i,o,s;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=W(e),n=S(t),a=_(this.config.chainConfig),i=q(e),(o=new b.eI).push(n),o.push(a),o.push(i),s=(0,Z.Xj)(o),this.updateProviderEngineProxy(s),r.next=12,this.lookupNetwork(e);case 12:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"lookupNetwork",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=this.config.chainConfig,this.update({chainId:t.chainId}),r.abrupt("return",t.chainId||"");case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()}]),t}(C);function L(r){return B.apply(this,arguments)}function B(){return B=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n,a,i,o,s;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.privKey,n=e.getProviderEngineProxy,a=function(r){var e=y().decode(r);return v.YW.from(e)},i=function(){return v.RG.fromSecretKey(A.from(t,"hex"))},"string"===typeof t){r.next=5;break}throw l.Ty.invalidParams("privKey must be a string");case 5:return o=i(),s={requestAccounts:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",[o.publicKey.toBase58()]);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getAccounts:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",[o.publicKey.toBase58()]);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),getPrivateKey:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t);case 1:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),signTransaction:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n,i;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(t=e.params)&&void 0!==t&&t.message){r.next=2;break}throw k.ethErrors.rpc.invalidParams("message");case 2:return(i=a(null===(n=e.params)||void 0===n?void 0:n.message)).partialSign(o),r.abrupt("return",i);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),signMessage:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(t=e.params)&&void 0!==t&&t.message){r.next=2;break}throw k.ethErrors.rpc.invalidParams("message");case 2:return n=g().sign.detached(e.params.message,o.secretKey),r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),signAndSendTransaction:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,i,s,c,u;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(t=e.params)&&void 0!==t&&t.message){r.next=2;break}throw k.ethErrors.rpc.invalidParams("message");case 2:if(s=n()){r.next=5;break}throw k.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return(c=a(null===(i=e.params)||void 0===i?void 0:i.message)).sign(o),r.next=9,s.request({method:"sendTransaction",params:[y().encode(c.serialize())]});case 9:return u=r.sent,r.abrupt("return",{signature:u});case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),signAllTransactions:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n,i,s,c,u,h,f;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(t=e.params)&&void 0!==t&&t.message&&null!==(n=e.params)&&void 0!==n&&n.message.length){r.next=2;break}throw k.ethErrors.rpc.invalidParams("message");case 2:i=[],s=(0,d.Z)((null===(h=e.params)||void 0===h?void 0:h.message)||[]);try{for(s.s();!(c=s.n()).done;)u=c.value,(f=a(u)).partialSign(o),i.push(f)}catch(p){s.e(p)}finally{s.f()}return r.abrupt("return",i);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},r.abrupt("return",s);case 8:case"end":return r.stop()}}),r)}))),B.apply(this,arguments)}function H(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function G(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?H(Object(t),!0).forEach((function(e){(0,f.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}var X=function(r){(0,c.Z)(t,r);var e=(0,u.Z)(t);function t(r){(0,n.Z)(this,t);var a=r.config,i=r.state;return e.call(this,{config:{chainConfig:G(G({},a.chainConfig),{},{chainNamespace:l.EN.SOLANA})},state:i})}return(0,a.Z)(t,[{key:"enable",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.state.privateKey){r.next=2;break}throw k.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return r.next=4,this.setupProvider(this.state.privateKey);case 4:return r.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"setupProvider",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n,a,i,o,s;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,L({privKey:e,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)});case 2:return t=r.sent,n=S(t),a=new b.eI,i=j(this.config.chainConfig),o=i.networkMiddleware,a.push(this.getChainSwitchMiddleware()),a.push(this.getAccountMiddleware()),a.push(n),a.push(o),s=(0,Z.Xj)(a),this.updateProviderEngineProxy(s),r.next=14,this.lookupNetwork();case 14:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"updateAccount",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._providerEngineProxy){r.next=2;break}throw k.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return r.next=4,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 4:if(r.sent===e.privateKey){r.next=14;break}return r.next=8,this.setupProvider(e.privateKey);case 8:return r.t0=this._providerEngineProxy,r.next=11,this._providerEngineProxy.request({method:"requestAccounts"});case 11:r.t1=r.sent,r.t2={accounts:r.t1},r.t0.emit.call(r.t0,"accountsChanged",r.t2);case 14:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"switchChain",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t,n;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._providerEngineProxy){r.next=2;break}throw k.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return t=this.getChainConfig(e.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:t}),r.next=7,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 7:return n=r.sent,r.next=10,this.setupProvider(n);case 10:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"lookupNetwork",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){var e,t;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._providerEngineProxy){r.next=2;break}throw k.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return r.next=4,this._providerEngineProxy.request({method:"getHealth",params:[]});case 4:if(e=r.sent,t=this.config.chainConfig,"ok"===e){r.next=8;break}throw l.Ty.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(t.rpcTarget));case 8:return this.update({chainId:t.chainId}),this.state.chainId!==t.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),r.abrupt("return",this.state.chainId);case 11:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"getChainSwitchMiddleware",value:function(){var r=this,e={addNewChainConfig:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){var n,a,i,o,s,c;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.params){e.next=2;break}throw k.ethErrors.rpc.invalidParams("Missing request params");case 2:if(n=t.params,a=n.chainId,i=n.chainName,o=n.rpcUrls,s=n.blockExplorerUrls,c=n.nativeCurrency,a){e.next=5;break}throw k.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(o&&0!==o.length){e.next=7;break}throw k.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(c){e.next=9;break}throw k.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:r.addChain({chainNamespace:l.EN.SOLANA,chainId:a,ticker:(null===c||void 0===c?void 0:c.symbol)||"SOL",tickerName:(null===c||void 0===c?void 0:c.name)||"Solana",displayName:i,rpcTarget:o[0],blockExplorer:(null===s||void 0===s?void 0:s[0])||""});case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),switchSolanaChain:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.params){e.next=2;break}throw k.ethErrors.rpc.invalidParams("Missing request params");case 2:if(t.params.chainId){e.next=4;break}throw k.ethErrors.rpc.invalidParams("Missing chainId");case 4:return e.next=6,r.switchChain(t.params);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return function(r){var e=r.addNewChainConfig,t=r.switchSolanaChain;return(0,b.UZ)([I("addSolanaChain",e),I("switchSolanaChain",t)])}(e)}},{key:"getAccountMiddleware",value:function(){var r=this,e={updatePrivatekey:function(){var e=(0,h.Z)((0,p.Z)().mark((function e(t){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.params){e.next=2;break}throw k.ethErrors.rpc.invalidParams("Missing request params");case 2:if(t.params.privateKey){e.next=4;break}throw k.ethErrors.rpc.invalidParams("Missing privateKey");case 4:return n=t.params.privateKey,e.next=7,r.updateAccount({privateKey:n});case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()};return function(r){var e=r.updatePrivatekey;return(0,b.UZ)([I("updateAccount",e)])}(e)}}]),t}(C);(0,f.Z)(X,"getProviderInstance",function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){var t;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new X({config:{chainConfig:e.chainConfig}}),r.next=3,t.setupProvider(e.privKey);case 3:return r.abrupt("return",t);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());function F(r,e,t){return new Promise((function(n,a){t>0?setTimeout((0,h.Z)((0,p.Z)().mark((function i(){var o;return(0,p.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r();case 2:(o=i.sent)&&n(o),o||F(r,e,t-1).then((function(r){return n(r),r})).catch((function(r){return a(r)}));case 5:case"end":return i.stop()}}),i)}))),e):n(!1)}))}var J=function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){var e,t,n=arguments;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{interval:1e3,count:3},!("undefined"!==typeof window&&!(null===(e=window.solana)||void 0===e||!e.isPhantom))){r.next=4;break}return r.abrupt("return",window.solana);case 4:return r.next=6,F((function(){var r;return null===(r=window.solana)||void 0===r?void 0:r.isPhantom}),t.interval,t.count);case 6:if(!r.sent){r.next=9;break}return r.abrupt("return",window.solana);case 9:return r.abrupt("return",null);case 10:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),$=function(r){(0,c.Z)(t,r);var e=(0,u.Z)(t);function t(){var r;(0,n.Z)(this,t);var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=e.call(this),(0,f.Z)((0,i.Z)(r),"name",l.rW.PHANTOM),(0,f.Z)((0,i.Z)(r),"adapterNamespace",l.yk.SOLANA),(0,f.Z)((0,i.Z)(r),"currentChainNamespace",l.EN.SOLANA),(0,f.Z)((0,i.Z)(r),"type",l.hN.EXTERNAL),(0,f.Z)((0,i.Z)(r),"status",l.MP.NOT_READY),(0,f.Z)((0,i.Z)(r),"_wallet",null),(0,f.Z)((0,i.Z)(r),"phantomProvider",null),(0,f.Z)((0,i.Z)(r),"rehydrated",!1),(0,f.Z)((0,i.Z)(r),"_onDisconnect",(function(){r._wallet&&(r._wallet.off("disconnect",r._onDisconnect),r.rehydrated=!1,r.status=r.status===l.MP.CONNECTED?l.MP.READY:l.MP.NOT_READY,r.emit(l.n2.DISCONNECTED))})),r.chainConfig=a.chainConfig||null,r}return(0,a.Z)(t,[{key:"isWalletConnected",get:function(){var r;return!(null===(r=this._wallet)||void 0===r||!r.isConnected||this.status!==l.MP.CONNECTED)}},{key:"provider",get:function(){var r;return(null===(r=this.phantomProvider)||void 0===r?void 0:r.provider)||null},set:function(r){throw new Error("Not implemented")}},{key:"setAdapterSettings",value:function(r){}},{key:"init",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(0,o.Z)((0,s.Z)(t.prototype),"checkInitializationRequirements",this).call(this),this.chainConfig||(this.chainConfig=(0,l.h2)(l.EN.SOLANA,"0x1")),r.next=4,J({interval:500,count:3});case 4:if(this._wallet=r.sent,this._wallet){r.next=7;break}throw l.Ty.notInstalled();case 7:if(this.phantomProvider=new z({config:{chainConfig:this.chainConfig}}),this.status=l.MP.READY,this.emit(l.n2.READY,l.rW.PHANTOM),r.prev=10,!e.autoConnect){r.next=15;break}return this.rehydrated=!0,r.next=15,this.connect();case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(10),l.cM.error("Failed to connect with cached phantom provider",r.t0),this.emit("ERRORED",r.t0);case 21:case"end":return r.stop()}}),r,this,[[10,17]])})));return function(e){return r.apply(this,arguments)}}()},{key:"connect",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){var e,n,a=this;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=this,r.prev=1,(0,o.Z)((0,s.Z)(t.prototype),"checkConnectionRequirements",this).call(this),this.status=l.MP.CONNECTING,this.emit(l.n2.CONNECTING,{adapter:l.rW.PHANTOM}),this._wallet){r.next=7;break}throw l.Ty.notInstalled();case 7:if(this._wallet.isConnected){r.next=24;break}return n=this._wallet._handleDisconnect,r.prev=9,r.next=12,new Promise((function(r,t){var i=function(){var e=(0,h.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.connectWithProvider(a._wallet);case 2:r(a.provider);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(!a._wallet)return t(l.Ty.notInstalled());a._wallet.once("connect",i),a._wallet._handleDisconnect=function(){t(l.Ty.windowClosed());for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return n.apply(e._wallet,a)},a._wallet.connect().catch((function(r){t(r)}))}));case 12:r.next=19;break;case 14:if(r.prev=14,r.t0=r.catch(9),!(r.t0 instanceof l.up)){r.next=18;break}throw r.t0;case 18:throw l.RM.connectionError(null===r.t0||void 0===r.t0?void 0:r.t0.message);case 19:return r.prev=19,this._wallet._handleDisconnect=n,r.finish(19);case 22:r.next=26;break;case 24:return r.next=26,this.connectWithProvider(this._wallet);case 26:if(this._wallet.publicKey){r.next=28;break}throw l.RM.connectionError();case 28:return this._wallet.on("disconnect",this._onDisconnect),r.abrupt("return",this.provider);case 32:throw r.prev=32,r.t1=r.catch(1),this.status=l.MP.READY,this.rehydrated=!1,this.emit(l.n2.ERRORED,r.t1),r.t1;case 38:case"end":return r.stop()}}),r,this,[[1,32],[9,14,19,22]])})));return function(){return r.apply(this,arguments)}}()},{key:"disconnect",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){var e,t,n=arguments;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=n.length>0&&void 0!==n[0]?n[0]:{cleanup:!1},this.isWalletConnected){r.next=3;break}throw l.RM.notConnectedError("Not connected with wallet");case 3:return r.prev=3,r.next=6,null===(t=this._wallet)||void 0===t?void 0:t.disconnect();case 6:e.cleanup&&(this.status=l.MP.NOT_READY,this.phantomProvider=null,this._wallet=null),this.emit(l.n2.DISCONNECTED),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(3),this.emit(l.n2.ERRORED,l.RM.disconnectionError(null===r.t0||void 0===r.t0?void 0:r.t0.message));case 13:case"end":return r.stop()}}),r,this,[[3,10]])})));return function(){return r.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.isWalletConnected){r.next=2;break}throw l.RM.notConnectedError("Not connected with wallet, Please login/connect first");case 2:return r.abrupt("return",{});case 3:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"connectWithProvider",value:function(){var r=(0,h.Z)((0,p.Z)().mark((function r(e){return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.phantomProvider){r.next=2;break}throw l.RM.connectionError("No phantom provider");case 2:return r.next=4,this.phantomProvider.setupProvider(e);case 4:return this.status=l.MP.CONNECTED,this.emit(l.n2.CONNECTED,{adapter:l.rW.PHANTOM,reconnected:this.rehydrated}),r.abrupt("return",this.provider);case 7:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()}]),t}(l.J5)}}]);